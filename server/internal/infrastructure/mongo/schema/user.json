{
  "$jsonSchema": {
    "bsonType": "object",
    "title": "User Collection Schema",
    "description": "Schema for user documents in the reearth-accounts database",
    "required": ["id", "name", "alias", "email", "subs", "workspace", "metadata", "password"],
    "properties": {
      "_id": {
        "bsonType": "objectId",
        "description": "MongoDB internal ID"
      },
      "id": {
        "bsonType": "string",
        "description": "User ID (ULID format)"
      },
      "name": {
        "bsonType": "string",
        "description": "User display name"
      },
      "alias": {
        "bsonType": "string",
        "description": "Unique user handle/alias. Default: \"\""
      },
      "email": {
        "bsonType": "string",
        "description": "User email address"
      },
      "subs": {
        "bsonType": "array",
        "description": "OAuth subject identifiers for authentication providers. Default: []",
        "items": {
          "bsonType": "string"
        }
      },
      "workspace": {
        "bsonType": "string",
        "description": "Personal workspace ID (ULID format)"
      },
      "team": {
        "bsonType": "string",
        "description": "Legacy team field (deprecated, use workspace)"
      },
      "lang": {
        "bsonType": "string",
        "description": "User language preference. Default: \"\" (deprecated, move to metadata)"
      },
      "theme": {
        "bsonType": "string",
        "description": "User UI theme preference. Default: \"\" (deprecated, move to metadata)"
      },
      "password": {
        "bsonType": "binData",
        "description": "Hashed password (bcrypt)"
      },
      "passwordreset": {
        "bsonType": ["object", "null"],
        "description": "Password reset token information",
        "properties": {
          "token": {
            "bsonType": "string",
            "description": "Password reset token. Default: \"\""
          },
          "createdat": {
            "bsonType": "date",
            "description": "Token creation timestamp"
          }
        }
      },
      "verification": {
        "bsonType": ["object", "null"],
        "description": "Email verification state. Default: null",
        "properties": {
          "code": {
            "bsonType": "string",
            "description": "Verification code. Default: \"\""
          },
          "expiration": {
            "bsonType": "date",
            "description": "Verification code expiration timestamp"
          },
          "verified": {
            "bsonType": "bool",
            "description": "Whether the email has been verified. Default: false"
          }
        }
      },
      "metadata": {
        "bsonType": "object",
        "description": "Extended user metadata. Default: {}",
        "properties": {
          "description": {
            "bsonType": "string",
            "description": "User bio/description. Default: \"\""
          },
          "website": {
            "bsonType": "string",
            "description": "User website URL. Default: \"\""
          },
          "photourl": {
            "bsonType": "string",
            "description": "Profile photo URL. Default: \"\""
          },
          "lang": {
            "bsonType": "string",
            "description": "Language metadata. Default: \"\""
          },
          "theme": {
            "bsonType": "string",
            "description": "Theme metadata. Default: \"\""
          }
        }
      }
    },
    "additionalProperties": false
  }
}
