{
  "$jsonSchema": {
    "additionalProperties": false,
    "bsonType": "object",
    "description": "Schema for user documents in the reearth-accounts database",
    "properties": {
      "_id": {
        "bsonType": "objectId",
        "description": "MongoDB internal ID"
      },
      "alias": {
        "bsonType": "string",
        "description": "Unique user handle/alias. Default: \"\""
      },
      "email": {
        "bsonType": "string",
        "description": "User email address"
      },
      "id": {
        "bsonType": "string",
        "description": "User ID (ULID format)"
      },
      "lang": {
        "bsonType": "string",
        "description": "User language preference. Default: \"\" (deprecated, move to metadata)"
      },
      "metadata": {
        "bsonType": "object",
        "description": "Extended user metadata. Default: {}",
        "properties": {
          "description": {
            "bsonType": "string",
            "description": "User bio/description. Default: \"\""
          },
          "lang": {
            "bsonType": "string",
            "description": "Language metadata. Default: \"\""
          },
          "photourl": {
            "bsonType": "string",
            "description": "Profile photo URL. Default: \"\""
          },
          "theme": {
            "bsonType": "string",
            "description": "Theme metadata. Default: \"\""
          },
          "website": {
            "bsonType": "string",
            "description": "User website URL. Default: \"\""
          }
        }
      },
      "name": {
        "bsonType": "string",
        "description": "User display name"
      },
      "password": {
        "bsonType": "binData",
        "description": "Hashed password (bcrypt)"
      },
      "passwordreset": {
        "bsonType": [
          "object",
          "null"
        ],
        "description": "Password reset token information",
        "properties": {
          "createdat": {
            "bsonType": "date",
            "description": "Token creation timestamp"
          },
          "token": {
            "bsonType": "string",
            "description": "Password reset token. Default: \"\""
          }
        }
      },
      "subs": {
        "bsonType": "array",
        "description": "OAuth subject identifiers for authentication providers. Default: []",
        "items": {
          "bsonType": "string"
        }
      },
      "team": {
        "bsonType": "string",
        "description": "Legacy team field (deprecated, use workspace)"
      },
      "theme": {
        "bsonType": "string",
        "description": "User UI theme preference. Default: \"\" (deprecated, move to metadata)"
      },
      "updatedAt": {
        "bsonType": "date",
        "description": "Last update timestamp"
      },
      "verification": {
        "bsonType": [
          "object",
          "null"
        ],
        "description": "Email verification state. Default: null",
        "properties": {
          "code": {
            "bsonType": "string",
            "description": "Verification code. Default: \"\""
          },
          "expiration": {
            "bsonType": "date",
            "description": "Verification code expiration timestamp"
          },
          "verified": {
            "bsonType": "bool",
            "description": "Whether the email has been verified. Default: false"
          }
        }
      },
      "workspace": {
        "bsonType": "string",
        "description": "Personal workspace ID (ULID format)"
      }
    },
    "required": [
      "id",
      "name",
      "alias",
      "email",
      "subs",
      "workspace",
      "password",
      "metadata",
      "updatedAt"
    ],
    "title": "User Collection Schema"
  }
}
