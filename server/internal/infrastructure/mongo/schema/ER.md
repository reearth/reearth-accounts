# Entity Relationship Diagram

<!-- This file is auto-generated by tools/cmd/ergen. Do not edit manually. -->

```mermaid
erDiagram
    Config {
        objectId _id PK
        object auth "optional"
        string defaultpolicy "optional"
        long migration "optional"
    }

    Permittable {
        objectId _id PK
        string id UK
        string[] roleids FK "role.id"
        string userid FK "user.id"
        object[] workspace_roles "optional"
    }

    Role {
        objectId _id PK
        string id UK
        string name
    }

    User {
        objectId _id PK
        string id UK
        string alias
        string email
        string lang "optional"
        object metadata
        string name
        binData password
        object passwordreset "optional"
        string[] subs
        string team "optional"
        string theme "optional"
        object verification "optional"
        string workspace FK "workspace.id"
    }

    Workspace {
        objectId _id PK
        string id UK
        string alias
        string email
        object integrations "optional"
        object members
        string members_hash "optional"
        object metadata
        string name
        bool personal
        string policy "optional"
    }

    User ||--o| Workspace : "has personal workspace"
    Workspace ||--o{ User : "has members"
    Permittable }o--|| User : "belongs to"
    Permittable }o--o{ Role : "has roles"
```

## Relationships

| From | To | Type | Description |
|------|-----|------|-------------|
| User | Workspace | 1:1 | Each user has a personal workspace (`user.workspace` → `workspace.id`) |
| Workspace | User | 1:N | Workspace has multiple members (`workspace.members[userId]`) |
| Permittable | User | N:1 | Permittable belongs to a user (`permittable.userid` → `user.id`) |
| Permittable | Role | N:M | Permittable has multiple roles (`permittable.roleids[]` → `role.id`) |
